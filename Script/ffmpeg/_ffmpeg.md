## ffmpeg 视频音频处理

---

#### ffmpeg 精要

###### 命令格式

```
ffmpeg {全局参数} {输入文件参数} -i {输入文件} {输出文件参数} {输出文件}
```

###### 命令参数

| 命令 | 简介 |
| --- | --- |
| -i | 设置输入文件
| -c copy | 直接复制，不经过重新编码（这样比较快）
| -c:v | 设置视频编码器
| -c:a | 设置音频编码器，相当于 -acodec，是 -codec:a 的简写
| -ss | 设置开始时间
| -t | 设置持续时间
| -to | 设置结束时间
| -b:a | 设置输出视频的码率
| -vf | 创建和设置过滤图，并用它来过滤流
| scale | 设置输出视频的宽度和高度
| setsar | 设置过滤器输出视频的样本纵横比
| -loop 1 | 无限循环
| -shortest | 让生成的视频最短化
| -an | 去除音频流
| -vn | 去除视频流
| -vframes | 设置要输出的视频帧数，相当于 -filter:v
|<img width=400px/>|<img width=500px/>|

###### 截取视频

```
ffmpeg -ss 00:02:25 -i 漠河舞厅.mp4 -to 00:05:34 -c copy output1.mp4

// ffmpeg 截视频默认采用关键帧，所以输出的时间和设置的时间可能有几秒的误差
```

###### 截取音频

```
ffmpeg -ss 00:02:24 -i 漠河舞厅.mp3 -to 00:05:34 -c copy output1.mp3
```

###### 音频转视频（加封面）

```
ffmpeg -loop 1 -i 漠河舞厅.jpg -i 漠河舞厅.mp3 -c:v libx264 -c:a aac -b:a 320k -vf scale=1080:1080 -shortest output1.mp4

// 选 320k 是因为音源的源码率
// 选 1080:1080 是因为专辑封面是正方形，而且源分辨率太大，需要压缩一下
```

---



